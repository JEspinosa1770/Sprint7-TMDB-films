
@if (isLoading()) {
  <div class="min-h-screen bg-gray-100 flex items-center justify-center">
    <div class="text-center">
      <div class="animate-spin rounded-full h-32 w-32 border-b-2 border-blue-600 mx-auto"></div>
      <p class="text-xl text-gray-600 mt-4">Cargando detalles...</p>
    </div>
  </div>
} @else if (error()) {
  <div class="min-h-screen bg-gray-100 flex items-center justify-center">
    <div class="text-center">
      <p class="text-2xl text-red-600 mb-4">{{ error() }}</p>
      <button (click)="goBack()" class="bg-blue-600 text-white px-6 py-2 rounded hover:bg-blue-700 transition-colors">Volver al listado</button>
    </div>
  </div>
} @else if (movie(); as film) {
  <div class="min-h-screen bg-gray-100 py-8">
    <div class="max-w-6xl mx-auto px-4">
      <button (click)="goBack()" class="mb-6 flex items-center px-3 py-2 cursor-pointer bg-blue-100 text-blue-600 rounded hover:text-blue-800 hover:scale-105 transition-colors">
        <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18"/>
        </svg>
        Volver al listado
      </button>

      <div class="bg-white rounded-lg shadow-lg overflow-hidden">
        <div class="md:flex bg-red-50">
          <div class="md:w-1/3">
            <img [src]="getPosterUrl(film.poster_path)" [alt]="film.title" class="w-full h-full object-cover rounded-2xl">
          </div>

          <div class="md:w-2/3 p-8">
            <h1 class="text-4xl font-bold mb-2">{{ film.title }}</h1>

            @if (film.tagline) {
              <p class="text-lg text-gray-500 italic mb-4">"{{ film.tagline }}"</p>
            }

            @if (film.original_title !== film.title) {
              <p class="text-xl text-gray-600 mb-4"><span class="strongKey">T√≠tulo original:</span> {{ film.original_title }}</p>
            }

            <div class="flex flex-wrap gap-4 mb-6">
              <div class="flex items-center">
                <span class="strongKey">Votos: </span>
                <span class="text-yellow-500 mr-1">‚≠ê</span>
                <span class="font-semibold">{{ film.vote_average.toFixed(1) }}</span>
                <span class="text-gray-500 ml-1">({{ film.vote_count }} votos)</span>
              </div>

              <div class="text-gray-600"><span class="strongKey">Estreno: </span>
                üìÖ {{ film.release_date }}
              </div>

              @if (film.runtime) {
                <div class="text-gray-600"><span class="strongKey">Duraci√≥n: </span>
                  ‚è±Ô∏è {{ film.runtime }} min
                </div>
              }

              <div class="text-gray-600"><span class="strongKey">Idioma original: </span>
                üåê {{ film.original_language.toUpperCase() }}
              </div>

              <div class="text-gray-600"><span class="strongKey">Popularidad: </span>
                üìä {{ film.popularity.toFixed(0) }}
              </div>

              @if (film.adult) {
                <span class="bg-red-600 text-white px-2 py-1 rounded text-sm font-semibold">
                  +18
                </span>
              }
            </div>

            @if (film.genres && film.genres.length > 0) {
              <div class="mb-6">
                <span class="strongKey">G√©neros: </span>
                <div class="flex flex-wrap gap-2 mt-2">
                  @for (genre of film.genres; track genre.id) {
                    <span class="bg-blue-100 text-blue-800 px-3 py-1 rounded-full text-sm">
                      {{ genre.name }}
                    </span>
                  }
                </div>
              </div>
            }

            <div class="mb-6">
              <h2 class="text-2xl font-semibold mb-3">Sinopsis</h2>
              <p class="text-gray-700 leading-relaxed">{{ film.overview }}</p>
            </div>
          </div>
        </div>

        <!-- Actores -->
        @if (film.credits && film.credits.cast && film.credits.cast.length > 0) {
          <div class="border-t border-gray-200 p-8">
            <h2 class="text-3xl font-semibold mb-6">Reparto principal</h2>
            <div class="grid grid-cols-2 md:grid-cols-4 lg:grid-cols-6 gap-4">
              @for (actor of film.credits.cast.slice(0, 12); track actor.id) {
                <div class="text-center">
                  <div class="mb-2 overflow-hidden rounded-lg shadow-md">
                    @if (actor.profile_path) {
                      <img [src]="apiService.getImageUrl(actor.profile_path, 'w185')" [alt]="actor.name" class="w-full h-48 object-cover transition-transform duration-300 hover:scale-105">
                    } @else {
                      <div class="w-full h-48 bg-gray-300 flex items-center justify-center">
                        <span class="text-gray-500 text-4xl">üë§</span>
                      </div>
                    }
                  </div>
                  <p class="font-semibold text-sm">{{ actor.name }}</p>
                  <p class="text-gray-600 text-xs">{{ actor.character }}</p>
                </div>
              }
            </div>
          </div>
        }

        <!-- Pel√≠culas Similares -->
        @if (film.similar && film.similar.results && film.similar.results.length > 0) {
          <div class="border-t border-gray-200 p-8 bg-gray-50">
            <h2 class="text-3xl font-semibold mb-6">Pel√≠culas similares</h2>
            <div class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-5 gap-4">
              @for (similar of film.similar.results.slice(0, 10); track similar.id) {
                <div class="bg-white rounded-lg shadow-md overflow-hidden hover:shadow-xl transition-shadow cursor-pointer"
                     (click)="loadMovieDetails(similar.id)">
                  @if (similar.poster_path) {
                    <img [src]="apiService.getImageUrl(similar.poster_path, 'w300')"
                         [alt]="similar.title"
                         class="w-full h-64 object-cover">
                  } @else {
                    <div class="w-full h-64 bg-gray-300 flex items-center justify-center">
                      <span class="text-gray-500 text-5xl">üé¨</span>
                    </div>
                  }
                  <div class="p-3">
                    <p class="font-semibold text-sm line-clamp-2">{{ similar.title }}</p>
                    <div class="flex items-center mt-1">
                      <span class="text-yellow-500 text-xs">‚≠ê</span>
                      <span class="text-xs ml-1">{{ similar.vote_average.toFixed(1) }}</span>
                    </div>
                  </div>
                </div>
              }
            </div>
          </div>
        }
      </div>
    </div>
  </div>
} @else {
  <div class="min-h-screen bg-gray-100 flex items-center justify-center">
    <div class="text-center">
      <p class="text-2xl text-gray-600 mb-4">Pel√≠cula no encontrada</p>
      <button (click)="goBack()" class="bg-blue-600 text-white px-6 py-2 rounded hover:bg-blue-700 transition-colors">
        Volver al listado
      </button>
    </div>
  </div>
}
